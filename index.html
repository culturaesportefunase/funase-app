<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sistema de Atividades - FUNASE</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Sistema de registro de atividades e convites da FUNASE - Funda√ß√£o de Atendimento Socioeducativo">
    <meta name="theme-color" content="#1e3a8a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="FUNASE">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- CSS Inline -->
    <style>
        /* ===== RESET E CONFIGURA√á√ïES GERAIS ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        /* ===== HEADER ===== */
        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
        }

        /* ===== LOGIN ===== */
        .login-container {
            padding: 50px;
            text-align: center;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        .login-form {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        .login-form h2 {
            color: #1e3a8a;
            margin-bottom: 30px;
            font-size: 2rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 25px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #1e3a8a;
            font-weight: 600;
            font-size: 1rem;
        }

        .form-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            background: white;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #3b82f6;
        }

        .login-btn {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .forgot-password-link {
            display: block;
            margin-top: 20px;
            color: #3b82f6;
            text-decoration: none;
            font-weight: 500;
        }

        .forgot-password-link:hover {
            text-decoration: underline;
        }

        .error-message {
            color: #dc3545;
            margin-top: 15px;
            font-weight: 500;
            padding: 10px;
            background: #f8d7da;
            border-radius: 8px;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            color: #155724;
            margin-top: 15px;
            font-weight: 500;
            padding: 10px;
            background: #d4edda;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
        }

        /* ===== CONTE√öDO PRINCIPAL ===== */
        .main-content {
            display: none;
            padding: 30px;
            background: #f8fafc;
        }

        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .user-welcome {
            color: #1e3a8a;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .logout-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        /* ===== MENU DE NAVEGA√á√ÉO ===== */
        .main-menu {
            margin-bottom: 30px;
        }

        .mobile-menu-toggle {
            display: none;
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 15px;
            width: 100%;
        }

        .menu-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .menu-button {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            color: #475569;
            border: 2px solid #e2e8f0;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .menu-button:hover {
            background: linear-gradient(135deg, #e2e8f0, #cbd5e1);
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }

        .menu-button.active {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            color: white;
            border-color: #1e3a8a;
            box-shadow: 0 4px 15px rgba(30, 58, 138, 0.3);
        }

        .menu-button.active:hover {
            background: linear-gradient(135deg, #1e40af, #2563eb);
        }

        /* ===== SE√á√ïES DE CONTE√öDO ===== */
        .content-section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }

        .content-section h2 {
            color: #1e3a8a;
            font-size: 1.8rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
            font-weight: 600;
        }

        /* ===== TELA DE BOAS-VINDAS ===== */
        .welcome-container {
            text-align: center;
            padding: 20px;
        }

        .welcome-header h2 {
            color: #1e3a8a;
            font-size: 2.2rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-header p {
            color: #64748b;
            font-size: 1.2rem;
            margin-bottom: 40px;
        }

        .welcome-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .action-card {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 30px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .action-card:hover {
            border-color: #3b82f6;
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.2);
            background: linear-gradient(135deg, #ffffff, #f1f5f9);
        }

        .action-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #3b82f6, #1e3a8a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .action-card h3 {
            color: #1e3a8a;
            font-size: 1.4rem;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .action-card p {
            color: #64748b;
            font-size: 1rem;
            line-height: 1.6;
        }

        /* ===== FORMUL√ÅRIOS ===== */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            background: #f8fafc;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            background: white;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* ===== BOT√ïES ===== */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #212529;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 193, 7, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.4);
        }

        /* ===== BOT√ïES DE A√á√ÉO PEQUENOS ===== */
        .action-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin: 0 5px;
        }

        .add-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .add-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .star-btn {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #212529;
        }

        .star-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 193, 7, 0.4);
        }

        .star-btn.favorited {
            background: gold;
            color: #212529;
        }

        /* ===== CONTAINERS DE PARTICIPANTES ===== */
        .participants-container,
        .team-container,
        .promoter-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }

        .participant-input,
        .team-member,
        .promoter-input {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            position: relative;
        }

        .input-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input-row input {
            flex: 1;
        }

        .button-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* ===== UPLOAD DE FOTOS ===== */
        .photo-container {
            border: 2px dashed #cbd5e1;
            border-radius: 15px;
            padding: 25px;
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        }

        .photo-upload-btn {
            width: 140px;
            height: 140px;
            border-radius: 15px;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 2px dashed #cbd5e1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            gap: 10px;
        }

        .photo-upload-btn:hover {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            border-color: #3b82f6;
            transform: translateY(-3px);
        }

        .photo-preview {
            width: 140px;
            height: 140px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            border: 2px solid #e2e8f0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-remove-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .photo-remove-btn:hover {
            background: rgba(220, 53, 69, 1);
            transform: scale(1.1);
        }

        /* ===== UNIDADES GRID ===== */
        .unidades-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .unidade-checkbox {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .unidade-checkbox:hover {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            border-color: #3b82f6;
        }

        .unidade-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            accent-color: #3b82f6;
            cursor: pointer;
        }

        .unidade-checkbox label {
            color: #1e3a8a;
            font-weight: 500;
            cursor: pointer;
            margin: 0;
            flex: 1;
        }

        /* ===== DASHBOARD ===== */
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border-color: #3b82f6;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e3a8a;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #64748b;
            font-size: 1rem;
            font-weight: 500;
        }

        .chart-container {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .chart-title {
            color: #1e3a8a;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        /* ===== RESPONSIVIDADE ===== */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .login-form,
            .main-content,
            .content-section {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .menu-container {
                display: none;
                flex-direction: column;
            }

            .menu-container.show {
                display: flex;
            }

            .welcome-actions {
                grid-template-columns: 1fr;
            }

            .action-card {
                padding: 20px 15px;
            }

            .action-icon {
                font-size: 2.5rem;
            }

            .unidades-grid {
                grid-template-columns: 1fr;
            }

            .dashboard-stats {
                grid-template-columns: 1fr;
            }
        }

        /* ===== UTILIT√ÅRIOS ===== */
        .text-center { text-align: center; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mt-3 { margin-top: 1.5rem; }
        .d-none { display: none; }
        .w-100 { width: 100%; }

        /* ===== ANIMA√á√ïES ===== */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content-section {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üèõÔ∏è FUNASE</h1>
            <p>Sistema de Atividades - Cultura, Lazer e Esportes</p>
        </div>

        <!-- Login Container -->
        <div id="loginContainer" class="login-container">
            <div class="login-form">
                <h2>üîê Acesso ao Sistema</h2>
                <div class="form-group">
                    <label for="email">E-mail Institucional</label>
                    <input type="email" id="email" placeholder="seu.email@funase.pe.gov.br" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" placeholder="Digite sua senha" required>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe">Lembrar-me</label>
                </div>
                <button type="button" class="login-btn" onclick="handleLogin()">Entrar no Sistema</button>
                <a href="#" class="forgot-password-link" onclick="forgotPassword()">Esqueci minha senha</a>
                <div id="loginError" class="error-message" style="display: none;"></div>
                <div id="loginSuccess" class="success-message" style="display: none;"></div>
            </div>
        </div>

        <!-- Main Content -->
        <div id="mainContent" class="main-content">
            <!-- User Info -->
            <div class="user-info">
                <div class="user-welcome">
                    <span id="userWelcome">Bem-vindo!</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">Sair</button>
            </div>

            <!-- Menu -->
            <div class="main-menu">
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">‚ò∞ Menu</button>
                <div class="menu-container" id="menuContainer">
                    <button class="menu-button active" onclick="showSection('welcome')">
                        <span class="menu-icon">üè†</span> In√≠cio
                    </button>
                    <button class="menu-button" onclick="showSection('form')">
                        <span class="menu-icon">üìù</span> Registrar Atividade
                    </button>
                    <button class="menu-button" onclick="showSection('convites')">
                        <span class="menu-icon">üé´</span> Cadastrar Convite
                    </button>
                    <button class="menu-button" onclick="showSection('dashboard')">
                        <span class="menu-icon">üìä</span> Dashboard
                    </button>
                    <button class="menu-button" onclick="showSection('usuarios')">
                        <span class="menu-icon">üë•</span> Cadastrar Usu√°rios
                    </button>
                    <button class="menu-button" onclick="showSection('backup')">
                        <span class="menu-icon">üõ°Ô∏è</span> Backup
                    </button>
                </div>
            </div>

            <!-- Welcome Section -->
            <div id="welcomeSection" class="content-section" style="display: block;">
                <div class="welcome-container">
                    <div class="welcome-header">
                        <h2>Bem-vindo ao Sistema FUNASE</h2>
                        <p>Gerencie atividades, convites e relat√≥rios de forma eficiente</p>
                    </div>
                    
                    <div class="welcome-actions">
                        <div class="action-card" onclick="showSection('form')">
                            <div class="action-icon">üìù</div>
                            <h3>Registrar Atividade</h3>
                            <p>Cadastre atividades culturais, esportivas e de lazer com fotos e participantes</p>
                        </div>
                        
                        <div class="action-card" onclick="showSection('convites')">
                            <div class="action-icon">üé´</div>
                            <h3>Cadastrar Convite</h3>
                            <p>Crie convites para eventos e gerencie inscri√ß√µes das unidades</p>
                        </div>
                        
                        <div class="action-card" onclick="showSection('dashboard')">
                            <div class="action-icon">üìä</div>
                            <h3>Dashboard</h3>
                            <p>Visualize estat√≠sticas e relat√≥rios das atividades realizadas</p>
                        </div>
                        
                        <div class="action-card" onclick="showSection('usuarios')">
                            <div class="action-icon">üë•</div>
                            <h3>Cadastrar Usu√°rios</h3>
                            <p>Gerencie usu√°rios e contatos para notifica√ß√µes</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Section -->
            <div id="formSection" class="content-section">
                <h2>üìù Registrar Atividade</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="activityType">Tipo de Atividade</label>
                        <select id="activityType" onchange="updateFormFields()">
                            <option value="">Selecione o tipo</option>
                            <option value="cultural">Cultural</option>
                            <option value="esportiva">Esportiva</option>
                            <option value="lazer">Lazer</option>
                            <option value="educativa">Educativa</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="activityName">Nome da Atividade</label>
                        <input type="text" id="activityName" placeholder="Digite o nome da atividade">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="activityDate">Data da Atividade</label>
                        <input type="date" id="activityDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="activityTime">Hor√°rio</label>
                        <input type="time" id="activityTime">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="activityLocation">Local</label>
                        <input type="text" id="activityLocation" placeholder="Local onde foi realizada a atividade">
                    </div>
                    
                    <div class="form-group">
                        <label for="activityScope">Tipo de Atividade</label>
                        <select id="activityScope">
                            <option value="">Selecione</option>
                            <option value="interna">Interna</option>
                            <option value="externa">Externa</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="activityDescription">Descri√ß√£o da Atividade</label>
                    <textarea id="activityDescription" placeholder="Descreva detalhadamente a atividade realizada..."></textarea>
                </div>

                <!-- Quem Promoveu -->
                <div class="form-group">
                    <label>Quem Promoveu</label>
                    <div id="promoterContainer" class="promoter-container">
                        <div class="promoter-input">
                            <div class="input-row">
                                <input type="text" placeholder="Nome de quem promoveu a atividade">
                                <div class="button-group">
                                    <button type="button" class="action-btn add-btn" onclick="addPromoter()" title="Adicionar promotor">+</button>
                                    <button type="button" class="action-btn star-btn" onclick="favoritePromoter(this)" title="Favoritar">‚≠ê</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Jovens Participantes -->
                <div class="form-group">
                    <label>Jovens Participantes</label>
                    <div id="participantsContainer" class="participants-container">
                        <div class="participant-input">
                            <div class="input-row">
                                <input type="text" placeholder="Nome do jovem participante">
                                <div class="button-group">
                                    <button type="button" class="action-btn add-btn" onclick="addParticipant()" title="Adicionar participante">+</button>
                                    <button type="button" class="action-btn star-btn" onclick="favoriteParticipant(this)" title="Favoritar">‚≠ê</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Equipe Participante -->
                <div class="form-group">
                    <label>Equipe Participante</label>
                    <div id="teamContainer" class="team-container">
                        <div class="team-member">
                            <div class="input-row">
                                <input type="text" placeholder="Nome do membro da equipe">
                                <input type="text" placeholder="Fun√ß√£o/Cargo">
                                <div class="button-group">
                                    <button type="button" class="action-btn add-btn" onclick="addTeamMember()" title="Adicionar membro">+</button>
                                    <button type="button" class="action-btn star-btn" onclick="favoriteTeamMember(this)" title="Favoritar">‚≠ê</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fotos da Atividade -->
                <div class="form-group">
                    <label>Fotos da Atividade (at√© 10 fotos)</label>
                    <input type="file" id="photoInput" multiple accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                    <div id="photoContainer" class="photo-container">
                        <div class="photo-upload-btn" onclick="document.getElementById('photoInput').click()">
                            <span style="font-size: 2rem;">üì∑</span>
                            <span>Adicionar Fotos</span>
                        </div>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="form-group text-center">
                    <button type="button" class="btn btn-success" onclick="saveActivity()">üíæ Salvar Atividade</button>
                    <button type="button" class="btn btn-warning" onclick="duplicateActivity()">üìã Duplicar Atividade</button>
                    <button type="button" class="btn btn-primary" onclick="addNewActivity()">‚ûï Acrescentar Atividade</button>
                </div>
            </div>

            <!-- Convites Section -->
            <div id="convitesSection" class="content-section">
                <h2>üé´ Cadastrar Convite</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="conviteNome">Nome do Evento</label>
                        <input type="text" id="conviteNome" placeholder="Nome do evento ou atividade">
                    </div>
                    
                    <div class="form-group">
                        <label for="conviteData">Data do Evento</label>
                        <input type="date" id="conviteData">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="conviteHorario">Hor√°rio</label>
                        <input type="time" id="conviteHorario">
                    </div>
                    
                    <div class="form-group">
                        <label for="conviteVagas">N√∫mero de Vagas</label>
                        <input type="number" id="conviteVagas" min="1" placeholder="Quantidade de vagas">
                    </div>
                </div>

                <div class="form-group">
                    <label for="conviteLocal">Local do Evento</label>
                    <input type="text" id="conviteLocal" placeholder="Local onde ser√° realizado">
                </div>

                <div class="form-group">
                    <label for="conviteDescricao">Descri√ß√£o do Evento</label>
                    <textarea id="conviteDescricao" placeholder="Descreva o evento, atividades, requisitos..."></textarea>
                </div>

                <!-- Upload de Imagem do Convite -->
                <div class="form-group">
                    <label>Imagem do Convite/Local</label>
                    <input type="file" id="conviteImageInput" accept="image/*" style="display: none;" onchange="handleConviteImageUpload(event)">
                    <div id="conviteImageContainer" class="photo-container">
                        <div class="photo-upload-btn" onclick="document.getElementById('conviteImageInput').click()">
                            <span style="font-size: 2rem;">üñºÔ∏è</span>
                            <span>Adicionar Imagem</span>
                        </div>
                    </div>
                </div>

                <!-- Unidades que podem participar -->
                <div class="form-group">
                    <label>Unidades que podem participar</label>
                    <div class="unidades-grid">
                        <div class="unidade-checkbox">
                            <input type="checkbox" id="todas-unidades" onchange="toggleAllUnits(this)">
                            <label for="todas-unidades">Todas as unidades</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Santa Luzia">
                            <label>Case Santa Luzia</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Jaboat√£o dos Guararapes">
                            <label>Case Jaboat√£o dos Guararapes</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Muribeca">
                            <label>Case Muribeca</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Pirapama">
                            <label>Case Pirapama</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Timba√∫ba">
                            <label>Case Timba√∫ba</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Vit√≥ria de Santo Ant√£o (Pacas)">
                            <label>Case Vit√≥ria de Santo Ant√£o (Pacas)</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Caruaru">
                            <label>Case Caruaru</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Garanhuns">
                            <label>Case Garanhuns</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Arcoverde">
                            <label>Case Arcoverde</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Case Petrolina">
                            <label>Case Petrolina</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Casem Petrolina">
                            <label>Casem Petrolina</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Casem Santa Luzia">
                            <label>Casem Santa Luzia</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Casem Harmonia">
                            <label>Casem Harmonia</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Casem Areias">
                            <label>Casem Areias</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Casem Iputinga">
                            <label>Casem Iputinga</label>
                        </div>
                        <div class="unidade-checkbox">
                            <input type="checkbox" name="unidade" value="Casem Caruaru">
                            <label>Casem Caruaru</label>
                        </div>
                    </div>
                </div>

                <div class="form-group text-center">
                    <button type="button" class="btn btn-success" onclick="publishConvite()">üì¢ Publicar Convite</button>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboardSection" class="content-section">
                <h2>üìä Dashboard</h2>
                
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalAtividades">0</div>
                        <div class="stat-label">Atividades Registradas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalConvites">0</div>
                        <div class="stat-label">Convites Publicados</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalParticipantes">0</div>
                        <div class="stat-label">Jovens Participantes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="percentualParticipacao">0%</div>
                        <div class="stat-label">% de Participa√ß√£o (base 400 jovens)</div>
                    </div>
                </div>

                <!-- Gr√°fico Comparativo Unidades -->
                <div class="chart-container">
                    <div class="chart-title">üìä Comparativo por Unidade - Atividades vs Jovens Enviados</div>
                    <div id="chartUnidades" style="min-height: 300px; display: flex; align-items: center; justify-content: center; color: #64748b;">
                        Gr√°fico ser√° exibido aqui com dados das atividades registradas
                    </div>
                </div>

                <!-- Gr√°fico de Participa√ß√£o -->
                <div class="chart-container">
                    <div class="chart-title">üìà Percentual de Participa√ß√£o vs Popula√ß√£o FUNASE</div>
                    <div id="chartParticipacao" style="min-height: 300px; display: flex; align-items: center; justify-content: center; color: #64748b;">
                        Gr√°fico de percentual de participa√ß√£o (base: ~400 jovens)
                    </div>
                </div>

                <!-- Gr√°fico por Unidade - Participantes Nominais -->
                <div class="chart-container">
                    <div class="chart-title">üë• Quantidade Nominal de Jovens por Unidade</div>
                    <div id="chartNominalUnidades" style="min-height: 300px; display: flex; align-items: center; justify-content: center; color: #64748b;">
                        Lista nominal de participantes por unidade
                    </div>
                </div>
            </div>

            <!-- Usu√°rios Section -->
            <div id="usuariosSection" class="content-section">
                <h2>üë• Cadastrar Usu√°rios</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="userEmail">E-mail do Usu√°rio</label>
                        <input type="email" id="userEmail" placeholder="usuario@funase.pe.gov.br">
                    </div>
                    
                    <div class="form-group">
                        <label for="userWhatsapp">WhatsApp</label>
                        <input type="tel" id="userWhatsapp" placeholder="(81) 99999-9999">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="userName">Nome Completo</label>
                        <input type="text" id="userName" placeholder="Nome completo do usu√°rio">
                    </div>
                    
                    <div class="form-group">
                        <label for="userUnit">Unidade</label>
                        <select id="userUnit">
                            <option value="">Selecione a unidade</option>
                            <option value="Case Santa Luzia">Case Santa Luzia</option>
                            <option value="Case Jaboat√£o dos Guararapes">Case Jaboat√£o dos Guararapes</option>
                            <option value="Case Muribeca">Case Muribeca</option>
                            <option value="Case Pirapama">Case Pirapama</option>
                            <option value="Case Timba√∫ba">Case Timba√∫ba</option>
                            <option value="Case Vit√≥ria de Santo Ant√£o (Pacas)">Case Vit√≥ria de Santo Ant√£o (Pacas)</option>
                            <option value="Case Caruaru">Case Caruaru</option>
                            <option value="Case Garanhuns">Case Garanhuns</option>
                            <option value="Case Arcoverde">Case Arcoverde</option>
                            <option value="Case Petrolina">Case Petrolina</option>
                            <option value="Casem Petrolina">Casem Petrolina</option>
                            <option value="Casem Santa Luzia">Casem Santa Luzia</option>
                            <option value="Casem Harmonia">Casem Harmonia</option>
                            <option value="Casem Areias">Casem Areias</option>
                            <option value="Casem Iputinga">Casem Iputinga</option>
                            <option value="Casem Caruaru">Casem Caruaru</option>
                        </select>
                    </div>
                </div>

                <div class="form-group text-center">
                    <button type="button" class="btn btn-primary" onclick="addUser()">‚ûï Cadastrar Usu√°rio</button>
                </div>

                <div class="form-group">
                    <h3 style="color: #1e3a8a; margin-bottom: 15px;">Usu√°rios Cadastrados</h3>
                    <div id="usersList" style="background: #f8fafc; padding: 20px; border-radius: 10px; border: 2px solid #e2e8f0;">
                        <p style="color: #64748b; text-align: center;">Nenhum usu√°rio cadastrado ainda</p>
                    </div>
                </div>
            </div>

            <!-- Backup Section -->
            <div id="backupSection" class="content-section">
                <h2>üõ°Ô∏è Sistema de Backup</h2>
                
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="lastBackup">Nunca</div>
                        <div class="stat-label">√öltimo Backup</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="backupSize">0 MB</div>
                        <div class="stat-label">Tamanho dos Dados</div>
                    </div>
                </div>

                <div class="text-center mt-3">
                    <button type="button" class="btn btn-primary" onclick="createBackup()">üì¶ Fazer Backup Completo</button>
                    <button type="button" class="btn btn-success" onclick="exportData()">üì§ Exportar Dados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // ===== VARI√ÅVEIS GLOBAIS =====
        let currentUser = null;
        let activities = JSON.parse(localStorage.getItem('funase_activities') || '[]');
        let convites = JSON.parse(localStorage.getItem('funase_convites') || '[]');
        let participants = JSON.parse(localStorage.getItem('funase_participants') || '[]');
        let photos = JSON.parse(localStorage.getItem('funase_photos') || '[]');
        let users = JSON.parse(localStorage.getItem('funase_users') || '[]');
        let photoCount = 0;

        // ===== INICIALIZA√á√ÉO =====
        document.addEventListener('DOMContentLoaded', function() {
            checkAutoLogin();
            updateDashboard();
            updateUsersList();
            registerServiceWorker();
        });

        // ===== FUN√á√ïES DE LOGIN =====
        function checkAutoLogin() {
            const savedCredentials = localStorage.getItem('funase_credentials');
            const rememberMe = localStorage.getItem('funase_remember');
            
            if (savedCredentials && rememberMe === 'true') {
                const credentials = JSON.parse(savedCredentials);
                document.getElementById('email').value = credentials.email;
                document.getElementById('password').value = credentials.password;
                document.getElementById('rememberMe').checked = true;
                
                currentUser = { email: credentials.email, name: credentials.email.split('@')[0] };
                showMainContent();
            }
        }

        function handleLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            // Valida√ß√£o b√°sica
            if (!email || !password) {
                showError('Por favor, preencha todos os campos.');
                return;
            }
            
            if (!email.includes('@funase.pe.gov.br')) {
                showError('Use apenas e-mails institucionais @funase.pe.gov.br');
                return;
            }
            
            // Simular autentica√ß√£o
            if (password === 'funase2024' || password === '123456') {
                currentUser = { email: email, name: email.split('@')[0] };
                
                if (rememberMe) {
                    localStorage.setItem('funase_credentials', JSON.stringify({ email, password }));
                    localStorage.setItem('funase_remember', 'true');
                } else {
                    localStorage.removeItem('funase_credentials');
                    localStorage.removeItem('funase_remember');
                }
                
                showSuccess('Login realizado com sucesso!');
                setTimeout(showMainContent, 1000);
            } else {
                showError('Senha incorreta. Tente: funase2024');
            }
        }

        function handleLogout() {
            currentUser = null;
            
            document.getElementById('loginContainer').style.display = 'block';
            document.getElementById('mainContent').style.display = 'none';
            
            // N√£o limpar campos se "lembrar-me" estiver marcado
            const rememberMe = localStorage.getItem('funase_remember');
            if (rememberMe !== 'true') {
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
                document.getElementById('rememberMe').checked = false;
            }
        }

        function forgotPassword() {
            alert('üìß Para recuperar sua senha, entre em contato com o administrador do sistema ou envie um e-mail para suporte@funase.pe.gov.br');
        }

        function showMainContent() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('userWelcome').textContent = `Bem-vindo, ${currentUser.name}!`;
        }

        function showError(message) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            document.getElementById('loginSuccess').style.display = 'none';
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('loginSuccess');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            document.getElementById('loginError').style.display = 'none';
        }

        // ===== NAVEGA√á√ÉO =====
        function showSection(sectionName) {
            // Esconder todas as se√ß√µes
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.style.display = 'none');
            
            // Remover classe active de todos os bot√µes
            const buttons = document.querySelectorAll('.menu-button');
            buttons.forEach(button => button.classList.remove('active'));
            
            // Mostrar se√ß√£o selecionada
            const targetSection = document.getElementById(sectionName + 'Section');
            if (targetSection) {
                targetSection.style.display = 'block';
            }
            
            // Ativar bot√£o correspondente
            const activeButton = event ? event.target.closest('.menu-button') : 
                                 document.querySelector(`[onclick*="'${sectionName}'"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }
        }

        function toggleMobileMenu() {
            const menuContainer = document.getElementById('menuContainer');
            menuContainer.classList.toggle('show');
        }

        // ===== FUN√á√ïES DO FORMUL√ÅRIO DE ATIVIDADE =====
        function updateFormFields() {
            const activityType = document.getElementById('activityType').value;
            console.log('Tipo de atividade selecionado:', activityType);
        }

        // Promotores
        function addPromoter() {
            const container = document.getElementById('promoterContainer');
            const newPromoter = document.createElement('div');
            newPromoter.className = 'promoter-input';
            newPromoter.innerHTML = `
                <div class="input-row">
                    <input type="text" placeholder="Nome de quem promoveu a atividade">
                    <div class="button-group">
                        <button type="button" class="btn btn-danger" onclick="removePromoter(this)" title="Remover">Remover</button>
                        <button type="button" class="action-btn star-btn" onclick="favoritePromoter(this)" title="Favoritar">‚≠ê</button>
                    </div>
                </div>
            `;
            container.appendChild(newPromoter);
        }

        function removePromoter(button) {
            button.closest('.promoter-input').remove();
        }

        function favoritePromoter(button) {
            button.classList.toggle('favorited');
        }

        // Participantes
        function addParticipant() {
            const container = document.getElementById('participantsContainer');
            const newParticipant = document.createElement('div');
            newParticipant.className = 'participant-input';
            newParticipant.innerHTML = `
                <div class="input-row">
                    <input type="text" placeholder="Nome do jovem participante">
                    <div class="button-group">
                        <button type="button" class="btn btn-danger" onclick="removeParticipant(this)" title="Remover">Remover</button>
                        <button type="button" class="action-btn star-btn" onclick="favoriteParticipant(this)" title="Favoritar">‚≠ê</button>
                    </div>
                </div>
            `;
            container.appendChild(newParticipant);
        }

        function removeParticipant(button) {
            button.closest('.participant-input').remove();
        }

        function favoriteParticipant(button) {
            button.classList.toggle('favorited');
        }

        // Equipe
        function addTeamMember() {
            const container = document.getElementById('teamContainer');
            const newMember = document.createElement('div');
            newMember.className = 'team-member';
            newMember.innerHTML = `
                <div class="input-row">
                    <input type="text" placeholder="Nome do membro da equipe">
                    <input type="text" placeholder="Fun√ß√£o/Cargo">
                    <div class="button-group">
                        <button type="button" class="btn btn-danger" onclick="removeTeamMember(this)" title="Remover">Remover</button>
                        <button type="button" class="action-btn star-btn" onclick="favoriteTeamMember(this)" title="Favoritar">‚≠ê</button>
                    </div>
                </div>
            `;
            container.appendChild(newMember);
        }

        function removeTeamMember(button) {
            button.closest('.team-member').remove();
        }

        function favoriteTeamMember(button) {
            button.classList.toggle('favorited');
        }

        // Upload de Fotos
        function handlePhotoUpload(event) {
            const files = event.target.files;
            const container = document.getElementById('photoContainer');
            
            for (let file of files) {
                if (photoCount >= 10) {
                    alert('‚ö†Ô∏è M√°ximo de 10 fotos permitidas por atividade!');
                    break;
                }
                
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const photoDiv = document.createElement('div');
                        photoDiv.className = 'photo-preview';
                        photoDiv.innerHTML = `
                            <img src="${e.target.result}" alt="Foto da atividade">
                            <button class="photo-remove-btn" onclick="removePhoto(this)">√ó</button>
                        `;
                        container.insertBefore(photoDiv, container.lastElementChild);
                        
                        photoCount++;
                        
                        // Salvar foto
                        photos.push({
                            id: Date.now() + Math.random(),
                            data: e.target.result,
                            name: file.name,
                            date: new Date().toISOString()
                        });
                        localStorage.setItem('funase_photos', JSON.stringify(photos));
                        updateDashboard();
                    };
                    reader.readAsDataURL(file);
                }
            }
            
            // Limpar input
            event.target.value = '';
        }

        function removePhoto(button) {
            button.closest('.photo-preview').remove();
            photoCount--;
        }

        // A√ß√µes da Atividade
        function saveActivity() {
            const activity = {
                id: Date.now(),
                type: document.getElementById('activityType').value,
                name: document.getElementById('activityName').value,
                date: document.getElementById('activityDate').value,
                time: document.getElementById('activityTime').value,
                location: document.getElementById('activityLocation').value,
                scope: document.getElementById('activityScope').value,
                description: document.getElementById('activityDescription').value,
                promoters: Array.from(document.querySelectorAll('#promoterContainer input')).map(input => input.value).filter(name => name.trim()),
                participants: Array.from(document.querySelectorAll('#participantsContainer input')).map(input => input.value).filter(name => name.trim()),
                team: Array.from(document.querySelectorAll('#teamContainer .input-row')).map(row => {
                    const inputs = row.querySelectorAll('input');
                    return {
                        name: inputs[0]?.value || '',
                        role: inputs[1]?.value || ''
                    };
                }).filter(member => member.name.trim()),
                createdAt: new Date().toISOString(),
                createdBy: currentUser.email
            };
            
            activities.push(activity);
            localStorage.setItem('funase_activities', JSON.stringify(activities));
            
            alert('‚úÖ Atividade salva com sucesso!');
            updateDashboard();
        }

        function duplicateActivity() {
            // Criar nova atividade baseada na atual
            const currentData = {
                type: document.getElementById('activityType').value,
                name: document.getElementById('activityName').value + ' (C√≥pia)',
                location: document.getElementById('activityLocation').value,
                scope: document.getElementById('activityScope').value,
                description: document.getElementById('activityDescription').value
            };
            
            // Limpar campos de data/hora para nova atividade
            document.getElementById('activityDate').value = '';
            document.getElementById('activityTime').value = '';
            document.getElementById('activityName').value = currentData.name;
            
            alert('üìã Atividade duplicada! Ajuste a data/hora e salve novamente.');
        }

        function addNewActivity() {
            // Limpar todos os campos
            document.getElementById('activityType').value = '';
            document.getElementById('activityName').value = '';
            document.getElementById('activityDate').value = '';
            document.getElementById('activityTime').value = '';
            document.getElementById('activityLocation').value = '';
            document.getElementById('activityScope').value = '';
            document.getElementById('activityDescription').value = '';
            
            // Limpar containers
            document.getElementById('promoterContainer').innerHTML = `
                <div class="promoter-input">
                    <div class="input-row">
                        <input type="text" placeholder="Nome de quem promoveu a atividade">
                        <div class="button-group">
                            <button type="button" class="action-btn add-btn" onclick="addPromoter()" title="Adicionar promotor">+</button>
                            <button type="button" class="action-btn star-btn" onclick="favoritePromoter(this)" title="Favoritar">‚≠ê</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('participantsContainer').innerHTML = `
                <div class="participant-input">
                    <div class="input-row">
                        <input type="text" placeholder="Nome do jovem participante">
                        <div class="button-group">
                            <button type="button" class="action-btn add-btn" onclick="addParticipant()" title="Adicionar participante">+</button>
                            <button type="button" class="action-btn star-btn" onclick="favoriteParticipant(this)" title="Favoritar">‚≠ê</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('teamContainer').innerHTML = `
                <div class="team-member">
                    <div class="input-row">
                        <input type="text" placeholder="Nome do membro da equipe">
                        <input type="text" placeholder="Fun√ß√£o/Cargo">
                        <div class="button-group">
                            <button type="button" class="action-btn add-btn" onclick="addTeamMember()" title="Adicionar membro">+</button>
                            <button type="button" class="action-btn star-btn" onclick="favoriteTeamMember(this)" title="Favoritar">‚≠ê</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Limpar fotos
            document.getElementById('photoContainer').innerHTML = `
                <div class="photo-upload-btn" onclick="document.getElementById('photoInput').click()">
                    <span style="font-size: 2rem;">üì∑</span>
                    <span>Adicionar Fotos</span>
                </div>
            `;
            photoCount = 0;
            
            alert('‚ûï Nova atividade iniciada! Preencha os dados.');
        }

        // ===== FUN√á√ïES DE CONVITES =====
        function handleConviteImageUpload(event) {
            const file = event.target.files[0];
            const container = document.getElementById('conviteImageContainer');
            
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Remover imagem anterior se existir
                    const existingPreview = container.querySelector('.photo-preview');
                    if (existingPreview) {
                        existingPreview.remove();
                    }
                    
                    const photoDiv = document.createElement('div');
                    photoDiv.className = 'photo-preview';
                    photoDiv.innerHTML = `
                        <img src="${e.target.result}" alt="Imagem do convite">
                        <button class="photo-remove-btn" onclick="removeConviteImage(this)">√ó</button>
                    `;
                    container.insertBefore(photoDiv, container.lastElementChild);
                };
                reader.readAsDataURL(file);
            }
        }

        function removeConviteImage(button) {
            button.closest('.photo-preview').remove();
        }

        function toggleAllUnits(checkbox) {
            const unitCheckboxes = document.querySelectorAll('input[name="unidade"]');
            unitCheckboxes.forEach(cb => cb.checked = checkbox.checked);
        }

        function publishConvite() {
            const convite = {
                id: Date.now(),
                nome: document.getElementById('conviteNome').value,
                data: document.getElementById('conviteData').value,
                horario: document.getElementById('conviteHorario').value,
                vagas: document.getElementById('conviteVagas').value,
                local: document.getElementById('conviteLocal').value,
                descricao: document.getElementById('conviteDescricao').value,
                unidades: Array.from(document.querySelectorAll('input[name="unidade"]:checked')).map(cb => cb.value),
                createdAt: new Date().toISOString(),
                createdBy: currentUser.email
            };
            
            convites.push(convite);
            localStorage.setItem('funase_convites', JSON.stringify(convites));
            
            // Simular envio de notifica√ß√µes
            const selectedUnits = convite.unidades;
            const registeredUsers = users.filter(user => selectedUnits.includes(user.unit));
            
            if (registeredUsers.length > 0) {
                alert(`üé´ Convite publicado com sucesso!\nüìß Notifica√ß√µes enviadas para ${registeredUsers.length} usu√°rios das unidades selecionadas.`);
            } else {
                alert('üé´ Convite publicado com sucesso!\n‚ö†Ô∏è Nenhum usu√°rio cadastrado para as unidades selecionadas. Cadastre usu√°rios na se√ß√£o "Cadastrar Usu√°rios".');
            }
            
            updateDashboard();
        }

        // ===== FUN√á√ïES DE USU√ÅRIOS =====
        function addUser() {
            const email = document.getElementById('userEmail').value;
            const whatsapp = document.getElementById('userWhatsapp').value;
            const name = document.getElementById('userName').value;
            const unit = document.getElementById('userUnit').value;
            
            if (!email || !name || !unit) {
                alert('‚ö†Ô∏è Preencha todos os campos obrigat√≥rios!');
                return;
            }
            
            if (!email.includes('@funase.pe.gov.br')) {
                alert('‚ö†Ô∏è Use apenas e-mails institucionais @funase.pe.gov.br');
                return;
            }
            
            const user = {
                id: Date.now(),
                email: email,
                whatsapp: whatsapp,
                name: name,
                unit: unit,
                createdAt: new Date().toISOString()
            };
            
            users.push(user);
            localStorage.setItem('funase_users', JSON.stringify(users));
            
            // Limpar campos
            document.getElementById('userEmail').value = '';
            document.getElementById('userWhatsapp').value = '';
            document.getElementById('userName').value = '';
            document.getElementById('userUnit').value = '';
            
            updateUsersList();
            alert('‚úÖ Usu√°rio cadastrado com sucesso!');
        }

        function updateUsersList() {
            const container = document.getElementById('usersList');
            
            if (users.length === 0) {
                container.innerHTML = '<p style="color: #64748b; text-align: center;">Nenhum usu√°rio cadastrado ainda</p>';
                return;
            }
            
            const userCards = users.map(user => `
                <div style="background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; border: 1px solid #e2e8f0;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong style="color: #1e3a8a;">${user.name}</strong><br>
                            <small style="color: #64748b;">${user.email}</small><br>
                            <small style="color: #64748b;">üì± ${user.whatsapp || 'N√£o informado'}</small><br>
                            <small style="color: #64748b;">üè¢ ${user.unit}</small>
                        </div>
                        <button class="btn btn-danger" onclick="removeUser(${user.id})" style="padding: 5px 10px; font-size: 12px;">Remover</button>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = userCards;
        }

        function removeUser(userId) {
            if (confirm('Tem certeza que deseja remover este usu√°rio?')) {
                users = users.filter(user => user.id !== userId);
                localStorage.setItem('funase_users', JSON.stringify(users));
                updateUsersList();
                alert('‚úÖ Usu√°rio removido com sucesso!');
            }
        }

        // ===== DASHBOARD =====
        function updateDashboard() {
            // Estat√≠sticas b√°sicas
            document.getElementById('totalAtividades').textContent = activities.length;
            document.getElementById('totalConvites').textContent = convites.length;
            
            // Contar participantes √∫nicos
            const allParticipants = activities.flatMap(activity => activity.participants || []);
            const uniqueParticipants = [...new Set(allParticipants.filter(p => p.trim()))];
            document.getElementById('totalParticipantes').textContent = uniqueParticipants.length;
            
            // Calcular percentual de participa√ß√£o (base 400 jovens)
            const participationPercent = ((uniqueParticipants.length / 400) * 100).toFixed(1);
            document.getElementById('percentualParticipacao').textContent = participationPercent + '%';
            
            // Atualizar backup info
            const lastBackup = localStorage.getItem('funase_last_backup');
            document.getElementById('lastBackup').textContent = lastBackup ? 
                new Date(lastBackup).toLocaleDateString('pt-BR') : 'Nunca';
            
            const dataSize = new Blob([JSON.stringify({activities, convites, participants, photos, users})]).size;
            document.getElementById('backupSize').textContent = (dataSize / 1024 / 1024).toFixed(2) + ' MB';
            
            // Atualizar gr√°ficos (simulado)
            updateCharts();
        }

        function updateCharts() {
            // Gr√°fico por unidades (simulado)
            const chartUnidades = document.getElementById('chartUnidades');
            if (activities.length > 0) {
                chartUnidades.innerHTML = `
                    <div style="text-align: left; width: 100%;">
                        <p><strong>Dados dispon√≠veis:</strong></p>
                        <p>‚Ä¢ Total de atividades registradas: ${activities.length}</p>
                        <p>‚Ä¢ Unidades com atividades: ${[...new Set(activities.map(a => a.createdBy))].length}</p>
                        <p>‚Ä¢ M√©dia de participantes por atividade: ${(activities.reduce((sum, a) => sum + (a.participants?.length || 0), 0) / activities.length).toFixed(1)}</p>
                        <p style="color: #64748b; font-style: italic; margin-top: 15px;">
                            üìä Gr√°fico interativo ser√° exibido quando houver mais dados de diferentes unidades
                        </p>
                    </div>
                `;
            }
            
            // Gr√°fico de participa√ß√£o
            const chartParticipacao = document.getElementById('chartParticipacao');
            const allParticipants = activities.flatMap(activity => activity.participants || []);
            const uniqueParticipants = [...new Set(allParticipants.filter(p => p.trim()))];
            
            if (uniqueParticipants.length > 0) {
                chartParticipacao.innerHTML = `
                    <div style="text-align: center;">
                        <div style="display: flex; justify-content: center; align-items: center; gap: 30px; margin: 20px 0;">
                            <div style="text-align: center;">
                                <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #28a745, #20c997); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2rem; margin: 0 auto;">
                                    ${uniqueParticipants.length}
                                </div>
                                <p style="margin-top: 10px; color: #28a745; font-weight: 600;">Participaram</p>
                            </div>
                            <div style="color: #64748b; font-size: 2rem;">vs</div>
                            <div style="text-align: center;">
                                <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #6c757d, #5a6268); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2rem; margin: 0 auto;">
                                    400
                                </div>
                                <p style="margin-top: 10px; color: #6c757d; font-weight: 600;">Total FUNASE</p>
                            </div>
                        </div>
                        <p style="color: #1e3a8a; font-size: 1.5rem; font-weight: 600;">
                            ${((uniqueParticipants.length / 400) * 100).toFixed(1)}% de participa√ß√£o
                        </p>
                    </div>
                `;
            }
            
            // Gr√°fico nominal por unidades
            const chartNominal = document.getElementById('chartNominalUnidades');
            if (uniqueParticipants.length > 0) {
                chartNominal.innerHTML = `
                    <div style="text-align: left; width: 100%;">
                        <p><strong>Participantes por Atividade:</strong></p>
                        ${activities.map(activity => `
                            <div style="margin-bottom: 15px; padding: 10px; background: #f8fafc; border-radius: 8px;">
                                <strong style="color: #1e3a8a;">${activity.name || 'Atividade sem nome'}</strong>
                                <br><small style="color: #64748b;">Data: ${activity.date || 'N√£o informada'}</small>
                                <br><small style="color: #64748b;">Participantes: ${activity.participants?.length || 0}</small>
                                ${activity.participants?.length > 0 ? 
                                    `<br><small style="color: #475569;">‚Ä¢ ${activity.participants.join(', ')}</small>` : 
                                    ''
                                }
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        // ===== FUN√á√ïES DE BACKUP =====
        function createBackup() {
            const backup = {
                activities: activities,
                convites: convites,
                participants: participants,
                photos: photos,
                users: users,
                timestamp: new Date().toISOString(),
                version: '2.0'
            };
            
            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-funase-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            localStorage.setItem('funase_last_backup', new Date().toISOString());
            updateDashboard();
            alert('üì¶ Backup criado e baixado com sucesso!');
        }

        function exportData() {
            const data = {
                activities: activities,
                convites: convites,
                users: users,
                statistics: {
                    totalActivities: activities.length,
                    totalConvites: convites.length,
                    totalParticipants: [...new Set(activities.flatMap(a => a.participants || []))].length,
                    totalPhotos: photos.length,
                    totalUsers: users.length
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `dados-funase-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            alert('üì§ Dados exportados com sucesso!');
        }

        // ===== SERVICE WORKER =====
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => console.log('SW registrado:', registration))
                    .catch(error => console.log('Erro no SW:', error));
            }
        }

        // ===== AUTO BACKUP =====
        setInterval(() => {
            const lastBackup = localStorage.getItem('funase_last_backup');
            const now = new Date();
            const lastBackupDate = lastBackup ? new Date(lastBackup) : new Date(0);
            const daysSinceBackup = (now - lastBackupDate) / (1000 * 60 * 60 * 24);
            
            if (daysSinceBackup >= 1) {
                console.log('Fazendo backup autom√°tico...');
                localStorage.setItem('funase_last_backup', now.toISOString());
            }
        }, 60000); // Verifica a cada minuto
    </script>
</body>
</html>

