<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Atividades Cultura, Lazer e Esportes - FUNASE</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Sistema de registro de atividades e convites da FUNASE - Funda√ß√£o de Atendimento Socioeducativo">
    <meta name="theme-color" content="#1e3a8a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="FUNASE">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="style.css">
    <style>
        /* Corre√ß√µes para bot√µes */
        .input-with-buttons {
            position: relative;
            width: 100%;
            margin-bottom: 15px;
        }
        
        .input-with-buttons input {
            width: 100%;
            padding: 12px;
            padding-right: 90px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .input-buttons {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            display: flex;
            align-items: center;
            padding-right: 5px;
        }
        
        .input-button {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            margin-left: 5px;
        }
        
        .dropdown-button {
            background: #6c757d;
            color: white;
        }
        
        .star-button {
            background: #ffc107;
            color: #212529;
        }
        
        .button-row {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            margin-bottom: 10px;
        }
        
        .action-button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 22px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .add-button {
            background: #28a745;
            color: white;
        }
        
        .remove-button {
            background: #dc3545;
            color: white;
        }
        
        .save-btn {
            background: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        
        .activity-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .dropdown-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        
        .dropdown-item:hover {
            background: #f8f9fa;
        }
        
        .photo-upload-btn {
            border: 2px dashed #ddd;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .photo-upload-btn:hover {
            border-color: #007bff;
            background: #f8f9fa;
        }
        
        .photo-preview {
            display: inline-block;
            margin: 5px;
            position: relative;
        }
        
        .photo-preview img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .photo-remove {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">üé≠</div>
                    <div class="title-section">
                        <h1>Atividades Cultura, Lazer e Esportes - FUNASE</h1>
                        <p>Sistema Seguro de Registro de Atividades</p>
                    </div>
                </div>
                <div class="user-section" id="userSection" style="display: none;">
                    <span id="userEmail"></span>
                    <button class="logout-btn" onclick="logout()">üö™ Sair</button>
                </div>
            </div>
        </header>

        <!-- Login Section -->
        <div id="loginSection" class="login-section">
            <div class="login-container">
                <div class="login-header">
                    <h2>üîê Acesso ao Sistema</h2>
                    <p>Entre com suas credenciais da FUNASE</p>
                </div>
                <form onsubmit="login(); return false;">
                    <div class="form-group">
                        <label for="email">üìß E-mail:</label>
                        <input type="email" id="email" placeholder="seu.email@funase.pe.gov.br" required>
                    </div>
                    <div class="form-group">
                        <label for="password">üîë Senha:</label>
                        <input type="password" id="password" placeholder="Digite sua senha" required>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="rememberMe"> Lembrar-me
                        </label>
                    </div>
                    <button type="submit" class="login-btn">üöÄ Entrar</button>
                </form>
            </div>
        </div>

        <!-- Navigation Menu -->
        <nav class="menu" id="menu" style="display: none;">
            <div class="menu-container">
                <button class="menu-button" onclick="showSection('formSection')">üìù Registrar Atividade</button>
                <button class="menu-button" id="cadastrarConviteBtn" onclick="showSection('cadastrarConviteSection')" style="display: none;">üé´ Cadastrar Convite</button>
                <button class="menu-button" onclick="showSection('convitesDisponiveisSection')">üì® Convites Dispon√≠veis</button>
                <button class="menu-button" onclick="showSection('minhasInscricoesSection')">‚úÖ Minhas Inscri√ß√µes</button>
                <button class="menu-button" onclick="showSection('savedFormsSection')">üìã Formul√°rios Salvos</button>
                <button class="menu-button" onclick="showSection('dashboardSection')">üìä Dashboard</button>
                <button class="menu-button" onclick="showSection('whatsappSection')">üì± Dados WhatsApp</button>
                <button class="menu-button" id="backupBtn" onclick="showSection('backupSection')" style="display: none;">üõ°Ô∏è Backup</button>
                <button class="menu-button" id="usuariosBtn" onclick="showSection('gerenciarUsuariosSection')" style="display: none;">üë• Usu√°rios</button>
                <button class="menu-button" id="relatoriosJuizBtn" onclick="showSection('relatoriosJuizSection')" style="display: none;">‚öñÔ∏è Relat√≥rios Juiz</button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content" id="mainContent" style="display: none;">
            
            <!-- Tela Inicial -->
            <div id="welcomeSection" class="content-section" style="display: block;">
                <div class="welcome-container">
                    <div class="welcome-header">
                        <h2>üéØ Bem-vindo ao Sistema FUNASE</h2>
                        <p>Escolha uma das op√ß√µes abaixo para come√ßar:</p>
                    </div>
                    
                    <div class="welcome-grid">
                        <div class="welcome-card" onclick="showSection('formSection')">
                            <div class="card-icon">üìù</div>
                            <h3>Registrar Atividade</h3>
                            <p>Cadastre uma nova atividade de cultura, lazer ou esportes</p>
                        </div>
                        
                        <div class="welcome-card" onclick="showSection('cadastrarConviteSection')" id="welcomeConviteCard" style="display: none;">
                            <div class="card-icon">üé´</div>
                            <h3>Cadastrar Convite</h3>
                            <p>Crie um novo convite para eventos e atividades</p>
                        </div>
                        
                        <div class="welcome-card" onclick="showSection('convitesDisponiveisSection')">
                            <div class="card-icon">üì®</div>
                            <h3>Convites Dispon√≠veis</h3>
                            <p>Veja e participe dos convites dispon√≠veis</p>
                        </div>
                        
                        <div class="welcome-card" onclick="showSection('minhasInscricoesSection')">
                            <div class="card-icon">‚úÖ</div>
                            <h3>Minhas Inscri√ß√µes</h3>
                            <p>Acompanhe suas inscri√ß√µes em atividades</p>
                        </div>
                        
                        <div class="welcome-card" onclick="showSection('savedFormsSection')">
                            <div class="card-icon">üìã</div>
                            <h3>Formul√°rios Salvos</h3>
                            <p>Acesse seus rascunhos e formul√°rios salvos</p>
                        </div>
                        
                        <div class="welcome-card" onclick="showSection('dashboardSection')">
                            <div class="card-icon">üìä</div>
                            <h3>Dashboard</h3>
                            <p>Visualize estat√≠sticas e relat√≥rios</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Section -->
            <div id="formSection" class="content-section">
                <div class="form-container">
                    <div class="activity-card" id="activity-1">
                        <div class="activity-header">
                            <div class="activity-title">üìù Atividade 1</div>
                            <div class="activity-actions">
                                <button class="remove-btn" onclick="removeActivity(1)">üóëÔ∏è Remover</button>
                            </div>
                        </div>
                        
                        <div class="form-row mobile-stack">
                            <div class="form-group">
                                <label for="data-1">üìÖ Data da Atividade:</label>
                                <input type="date" id="data-1" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="periodo-1">‚è∞ Per√≠odo:</label>
                                <select id="periodo-1" required>
                                    <option value="">Selecione o per√≠odo...</option>
                                    <option value="Manh√£">‚òÄÔ∏è Manh√£</option>
                                    <option value="Tarde">üåÖ Tarde</option>
                                    <option value="Noite">üåô Noite</option>
                                    <option value="Integral">üìÖ Integral</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="tipo-atividade-1">üè† Tipo de Atividade:</label>
                                <select id="tipo-atividade-1" required>
                                    <option value="">Selecione o tipo...</option>
                                    <option value="Interna">üè¢ Atividade Interna</option>
                                    <option value="Externa">üåç Atividade Externa</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="atividade-1">üéØ Nome da Atividade:</label>
                            <div class="input-with-buttons">
                                <input type="text" id="atividade-1" placeholder="Digite o nome da atividade ou clique na seta para ver op√ß√µes" required>
                                <div class="input-buttons">
                                    <button class="input-button dropdown-button" onclick="toggleActivityDropdown(1)" title="Ver op√ß√µes">‚¨áÔ∏è</button>
                                    <button class="input-button star-button" onclick="saveFavoriteActivity(1)" title="Salvar como Favorita">‚≠ê</button>
                                </div>
                                <div class="activity-dropdown" id="dropdown-1" style="display: none;"></div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="description-1">üìù Descri√ß√£o Detalhada da Atividade (opcional):</label>
                            <textarea id="description-1" rows="5" placeholder="Descreva detalhadamente como foi a atividade..." oninput="updateCharCounter(1)"></textarea>
                            <div class="char-counter" id="char-counter-1">0 / 1000 palavras</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="promotor-1">üé™ Promovido por:</label>
                            <div class="promotor-container">
                                <select id="promotor-1" required>
                                    <option value="">Selecione quem promoveu...</option>
                                    <option value="Pr√≥pria Unidade">üè¢ Pr√≥pria Unidade</option>
                                    <option value="Eixo Cultura">üé≠ Eixo Cultura</option>
                                </select>
                                <div class="button-row">
                                    <button class="action-button add-button" onclick="addPromotor(1)" title="Adicionar Novo Promotor">‚ûï</button>
                                    <button class="action-button star-button" onclick="saveFavoritePromotor(1)" title="Salvar Promotor como Favorito">‚≠ê</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="jovens-1">üë• Jovens Participantes:</label>
                            <div class="participants-container" id="jovens-container-1">
                                <div class="participant-input" id="jovem-input-1-1">
                                    <input type="text" id="jovem-1-1" placeholder="Nome do jovem 1" oninput="updateParticipantStatus(1, 1, 'jovem')">
                                </div>
                                <div class="button-row">
                                    <button class="action-button add-button" onclick="addJovem(1)" title="Adicionar Jovem">‚ûï</button>
                                    <button class="action-button star-button" onclick="saveFavoriteJovem(1, 1)" title="Salvar Jovem como Favorito">‚≠ê</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="equipe-1">üëî Equipe Participante:</label>
                            <div class="team-container" id="equipe-container-1">
                                <div class="team-member" id="equipe-member-1-1">
                                    <input type="text" id="equipe-nome-1-1" placeholder="Nome do membro da equipe" oninput="updateParticipantStatus(1, 1, 'equipe')">
                                    <button class="action-button star-button" onclick="saveFavoriteParticipante(1, 1)" title="Salvar Participante como Favorito">‚≠ê</button>
                                    
                                    <div class="cargo-container">
                                        <div class="input-with-buttons">
                                            <input type="text" id="equipe-cargo-1-1" placeholder="Digite o cargo ou clique na seta" oninput="updateParticipantStatus(1, 1, 'cargo')">
                                            <div class="input-buttons">
                                                <button class="input-button dropdown-button" onclick="toggleCargoDropdown(1, 1)" title="Ver op√ß√µes">‚¨áÔ∏è</button>
                                                <button class="input-button star-button" onclick="saveFavoriteCargo(1, 1)" title="Salvar Cargo como Favorito">‚≠ê</button>
                                            </div>
                                            <div class="activity-dropdown" id="cargo-dropdown-1-1" style="display: none;"></div>
                                        </div>
                                    </div>
                                </div>
                                <button class="action-button add-button" onclick="addTeamMember(1)" title="Adicionar Membro da Equipe">‚ûï</button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>üì∏ Fotos da Atividade (at√© 10 fotos):</label>
                            <div class="photo-container" id="photo-container-1">
                                <input type="file" id="photo-input-1" accept="image/*" multiple style="display: none;" onchange="handlePhotoUpload(this, 1)">
                                <div class="photo-upload-btn" onclick="triggerPhotoUpload(1)">
                                    <span>üì∑</span>
                                    <span>Adicionar Fotos</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button class="save-btn" onclick="saveActivity(1)">üíæ Salvar</button>
                            <button class="save-btn" onclick="sendActivity(1)">üìß Enviar</button>
                        </div>
                    </div>
                    
                    <div class="add-activity-container">
                        <button class="add-activity-btn" onclick="addNewActivity()">‚ûï Adicionar Nova Atividade</button>
                        <button class="duplicate-btn" onclick="duplicateLastActivity()">üìã Duplicar √öltima Atividade</button>
                    </div>
                </div>
            </div>

            <!-- Outras se√ß√µes aqui... -->
            
        </main>
    </div>

    <script>
        // Vari√°veis globais
        let currentUser = null;
        let activityCounter = 1;
        let favoriteActivities = JSON.parse(localStorage.getItem('favoriteActivities') || '[]');
        let favoritePromotors = JSON.parse(localStorage.getItem('favoritePromotors') || '[]');
        let favoriteCargos = JSON.parse(localStorage.getItem('favoriteCargos') || '[]');
        let favoriteJovens = JSON.parse(localStorage.getItem('favoriteJovens') || '[]');

        // Fun√ß√£o de login
        function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            if (!email.endsWith('@funase.pe.gov.br')) {
                alert('‚ùå Use apenas e-mails @funase.pe.gov.br');
                return;
            }
            
            if (password !== 'funase2024') {
                alert('‚ùå Senha incorreta');
                return;
            }
            
            currentUser = email;
            
            if (rememberMe) {
                localStorage.setItem('rememberedUser', email);
            }
            
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('menu').style.display = 'block';
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('userSection').style.display = 'block';
            document.getElementById('userEmail').textContent = email;
            
            // Mostrar bot√µes administrativos para cultura@funase.pe.gov.br
            if (email === 'cultura@funase.pe.gov.br') {
                document.getElementById('cadastrarConviteBtn').style.display = 'block';
                document.getElementById('backupBtn').style.display = 'block';
                document.getElementById('usuariosBtn').style.display = 'block';
                document.getElementById('relatoriosJuizBtn').style.display = 'block';
                document.getElementById('welcomeConviteCard').style.display = 'block';
            }
            
            showSection('welcomeSection');
        }

        // Fun√ß√£o de logout
        function logout() {
            currentUser = null;
            localStorage.removeItem('rememberedUser');
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('menu').style.display = 'none';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('userSection').style.display = 'none';
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
        }

        // Fun√ß√£o para mostrar se√ß√µes
        function showSection(sectionId) {
            // Esconder todas as se√ß√µes
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            
            // Mostrar se√ß√£o selecionada
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        }

        // FUN√á√ïES DOS BOT√ïES DE ATIVIDADE

        // Toggle dropdown de atividades
        function toggleActivityDropdown(activityId) {
            const dropdown = document.getElementById(`dropdown-${activityId}`);
            if (dropdown.style.display === 'none') {
                loadActivityDropdown(activityId);
                dropdown.style.display = 'block';
            } else {
                dropdown.style.display = 'none';
            }
        }

        // Carregar op√ß√µes do dropdown
        function loadActivityDropdown(activityId) {
            const dropdown = document.getElementById(`dropdown-${activityId}`);
            const activities = [
                'üé≠ Teatro',
                'üéµ M√∫sica',
                'üé® Artes Pl√°sticas',
                '‚öΩ Futebol',
                'üèÄ Basquete',
                'üèê V√¥lei',
                'üéÆ Jogos',
                'üìö Leitura',
                'üé™ Circo',
                'üíÉ Dan√ßa'
            ];
            
            dropdown.innerHTML = '';
            activities.forEach(activity => {
                const item = document.createElement('div');
                item.className = 'dropdown-item';
                item.textContent = activity;
                item.onclick = () => selectActivity(activityId, activity);
                dropdown.appendChild(item);
            });
            
            // Adicionar favoritas
            favoriteActivities.forEach(activity => {
                const item = document.createElement('div');
                item.className = 'dropdown-item';
                item.textContent = `‚≠ê ${activity}`;
                item.onclick = () => selectActivity(activityId, activity);
                dropdown.appendChild(item);
            });
        }

        // Selecionar atividade do dropdown
        function selectActivity(activityId, activity) {
            document.getElementById(`atividade-${activityId}`).value = activity.replace('‚≠ê ', '');
            document.getElementById(`dropdown-${activityId}`).style.display = 'none';
        }

        // Salvar atividade como favorita
        function saveFavoriteActivity(activityId) {
            const activity = document.getElementById(`atividade-${activityId}`).value;
            if (activity && !favoriteActivities.includes(activity)) {
                favoriteActivities.push(activity);
                localStorage.setItem('favoriteActivities', JSON.stringify(favoriteActivities));
                alert('‚≠ê Atividade salva como favorita!');
            }
        }

        // Adicionar jovem
        function addJovem(activityId) {
            const container = document.getElementById(`jovens-container-${activityId}`);
            const jovemCount = container.querySelectorAll('.participant-input').length + 1;
            
            const newJovem = document.createElement('div');
            newJovem.className = 'participant-input';
            newJovem.id = `jovem-input-${activityId}-${jovemCount}`;
            newJovem.innerHTML = `
                <input type="text" id="jovem-${activityId}-${jovemCount}" placeholder="Nome do jovem ${jovemCount}" oninput="updateParticipantStatus(${activityId}, ${jovemCount}, 'jovem')">
                <button class="action-button remove-button" onclick="removeJovem(${activityId}, ${jovemCount})" title="Remover Jovem">üóëÔ∏è</button>
            `;
            
            // Inserir antes dos bot√µes
            const buttonRow = container.querySelector('.button-row');
            container.insertBefore(newJovem, buttonRow);
        }

        // Remover jovem
        function removeJovem(activityId, jovemId) {
            const jovemElement = document.getElementById(`jovem-input-${activityId}-${jovemId}`);
            if (jovemElement) {
                jovemElement.remove();
            }
        }

        // Salvar jovem como favorito
        function saveFavoriteJovem(activityId, jovemId) {
            const jovem = document.getElementById(`jovem-${activityId}-${jovemId}`).value;
            if (jovem && !favoriteJovens.includes(jovem)) {
                favoriteJovens.push(jovem);
                localStorage.setItem('favoriteJovens', JSON.stringify(favoriteJovens));
                alert('‚≠ê Jovem salvo como favorito!');
            }
        }

        // Adicionar membro da equipe
        function addTeamMember(activityId) {
            const container = document.getElementById(`equipe-container-${activityId}`);
            const memberCount = container.querySelectorAll('.team-member').length + 1;
            
            const newMember = document.createElement('div');
            newMember.className = 'team-member';
            newMember.id = `equipe-member-${activityId}-${memberCount}`;
            newMember.innerHTML = `
                <input type="text" id="equipe-nome-${activityId}-${memberCount}" placeholder="Nome do membro da equipe" oninput="updateParticipantStatus(${activityId}, ${memberCount}, 'equipe')">
                <button class="action-button star-button" onclick="saveFavoriteParticipante(${activityId}, ${memberCount})" title="Salvar Participante como Favorito">‚≠ê</button>
                <button class="action-button remove-button" onclick="removeTeamMember(${activityId}, ${memberCount})" title="Remover Membro">üóëÔ∏è</button>
                
                <div class="cargo-container">
                    <div class="input-with-buttons">
                        <input type="text" id="equipe-cargo-${activityId}-${memberCount}" placeholder="Digite o cargo ou clique na seta" oninput="updateParticipantStatus(${activityId}, ${memberCount}, 'cargo')">
                        <div class="input-buttons">
                            <button class="input-button dropdown-button" onclick="toggleCargoDropdown(${activityId}, ${memberCount})" title="Ver op√ß√µes">‚¨áÔ∏è</button>
                            <button class="input-button star-button" onclick="saveFavoriteCargo(${activityId}, ${memberCount})" title="Salvar Cargo como Favorito">‚≠ê</button>
                        </div>
                        <div class="activity-dropdown" id="cargo-dropdown-${activityId}-${memberCount}" style="display: none;"></div>
                    </div>
                </div>
            `;
            
            // Inserir antes do bot√£o de adicionar
            const addButton = container.querySelector('.add-button');
            container.insertBefore(newMember, addButton);
        }

        // Remover membro da equipe
        function removeTeamMember(activityId, memberId) {
            const memberElement = document.getElementById(`equipe-member-${activityId}-${memberId}`);
            if (memberElement) {
                memberElement.remove();
            }
        }

        // Toggle dropdown de cargos
        function toggleCargoDropdown(activityId, memberId) {
            const dropdown = document.getElementById(`cargo-dropdown-${activityId}-${memberId}`);
            if (dropdown.style.display === 'none') {
                loadCargoDropdown(activityId, memberId);
                dropdown.style.display = 'block';
            } else {
                dropdown.style.display = 'none';
            }
        }

        // Carregar op√ß√µes de cargo
        function loadCargoDropdown(activityId, memberId) {
            const dropdown = document.getElementById(`cargo-dropdown-${activityId}-${memberId}`);
            const cargos = [
                'üë®‚Äçüè´ Professor',
                'üë©‚Äçüíº Coordenador',
                'üë®‚Äç‚öïÔ∏è Psic√≥logo',
                'üë©‚Äç‚öïÔ∏è Assistente Social',
                'üë®‚Äçüíª T√©cnico',
                'üë©‚Äçüéì Pedagogo',
                'üë®‚Äçüé® Arte-educador',
                'üë©‚ÄçüèÉ Educador F√≠sico'
            ];
            
            dropdown.innerHTML = '';
            cargos.forEach(cargo => {
                const item = document.createElement('div');
                item.className = 'dropdown-item';
                item.textContent = cargo;
                item.onclick = () => selectCargo(activityId, memberId, cargo);
                dropdown.appendChild(item);
            });
            
            // Adicionar favoritos
            favoriteCargos.forEach(cargo => {
                const item = document.createElement('div');
                item.className = 'dropdown-item';
                item.textContent = `‚≠ê ${cargo}`;
                item.onclick = () => selectCargo(activityId, memberId, cargo);
                dropdown.appendChild(item);
            });
        }

        // Selecionar cargo
        function selectCargo(activityId, memberId, cargo) {
            document.getElementById(`equipe-cargo-${activityId}-${memberId}`).value = cargo.replace('‚≠ê ', '');
            document.getElementById(`cargo-dropdown-${activityId}-${memberId}`).style.display = 'none';
        }

        // Salvar cargo como favorito
        function saveFavoriteCargo(activityId, memberId) {
            const cargo = document.getElementById(`equipe-cargo-${activityId}-${memberId}`).value;
            if (cargo && !favoriteCargos.includes(cargo)) {
                favoriteCargos.push(cargo);
                localStorage.setItem('favoriteCargos', JSON.stringify(favoriteCargos));
                alert('‚≠ê Cargo salvo como favorito!');
            }
        }

        // Salvar participante como favorito
        function saveFavoriteParticipante(activityId, memberId) {
            const nome = document.getElementById(`equipe-nome-${activityId}-${memberId}`).value;
            if (nome && !favoriteJovens.includes(nome)) {
                favoriteJovens.push(nome);
                localStorage.setItem('favoriteJovens', JSON.stringify(favoriteJovens));
                alert('‚≠ê Participante salvo como favorito!');
            }
        }

        // Adicionar promotor
        function addPromotor(activityId) {
            const promotor = prompt('Digite o nome do novo promotor:');
            if (promotor) {
                const select = document.getElementById(`promotor-${activityId}`);
                const option = document.createElement('option');
                option.value = promotor;
                option.textContent = promotor;
                select.appendChild(option);
                select.value = promotor;
            }
        }

        // Salvar promotor como favorito
        function saveFavoritePromotor(activityId) {
            const promotor = document.getElementById(`promotor-${activityId}`).value;
            if (promotor && !favoritePromotors.includes(promotor)) {
                favoritePromotors.push(promotor);
                localStorage.setItem('favoritePromotors', JSON.stringify(favoritePromotors));
                alert('‚≠ê Promotor salvo como favorito!');
            }
        }

        // Trigger upload de fotos
        function triggerPhotoUpload(activityId) {
            document.getElementById(`photo-input-${activityId}`).click();
        }

        // Handle upload de fotos
        function handlePhotoUpload(input, activityId) {
            const container = document.getElementById(`photo-container-${activityId}`);
            const files = input.files;
            
            for (let i = 0; i < files.length && i < 10; i++) {
                const file = files[i];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const preview = document.createElement('div');
                    preview.className = 'photo-preview';
                    preview.innerHTML = `
                        <img src="${e.target.result}" alt="Foto da atividade">
                        <button class="photo-remove" onclick="removePhoto(this)">√ó</button>
                    `;
                    
                    // Inserir antes do bot√£o de upload
                    const uploadBtn = container.querySelector('.photo-upload-btn');
                    container.insertBefore(preview, uploadBtn);
                };
                
                reader.readAsDataURL(file);
            }
        }

        // Remover foto
        function removePhoto(button) {
            button.parentElement.remove();
        }

        // Salvar atividade
        function saveActivity(activityId) {
            const data = {
                id: activityId,
                data: document.getElementById(`data-${activityId}`).value,
                periodo: document.getElementById(`periodo-${activityId}`).value,
                tipo: document.getElementById(`tipo-atividade-${activityId}`).value,
                atividade: document.getElementById(`atividade-${activityId}`).value,
                descricao: document.getElementById(`description-${activityId}`).value,
                promotor: document.getElementById(`promotor-${activityId}`).value,
                timestamp: new Date().toISOString()
            };
            
            // Coletar jovens
            data.jovens = [];
            const jovensInputs = document.querySelectorAll(`#jovens-container-${activityId} input[type="text"]`);
            jovensInputs.forEach(input => {
                if (input.value.trim()) {
                    data.jovens.push(input.value.trim());
                }
            });
            
            // Coletar equipe
            data.equipe = [];
            const equipeMembers = document.querySelectorAll(`#equipe-container-${activityId} .team-member`);
            equipeMembers.forEach(member => {
                const nome = member.querySelector('input[id*="equipe-nome"]').value;
                const cargo = member.querySelector('input[id*="equipe-cargo"]').value;
                if (nome.trim()) {
                    data.equipe.push({ nome: nome.trim(), cargo: cargo.trim() });
                }
            });
            
            // Salvar no localStorage
            let savedActivities = JSON.parse(localStorage.getItem('savedActivities') || '[]');
            const existingIndex = savedActivities.findIndex(activity => activity.id === activityId);
            
            if (existingIndex >= 0) {
                savedActivities[existingIndex] = data;
            } else {
                savedActivities.push(data);
            }
            
            localStorage.setItem('savedActivities', JSON.stringify(savedActivities));
            
            alert('üíæ Atividade salva com sucesso!');
        }

        // Enviar atividade
        function sendActivity(activityId) {
            saveActivity(activityId);
            alert('üìß Atividade enviada por e-mail! (Funcionalidade simulada)');
        }

        // Adicionar nova atividade
        function addNewActivity() {
            activityCounter++;
            // Implementar l√≥gica para adicionar nova atividade
            alert('‚ûï Nova atividade adicionada!');
        }

        // Duplicar √∫ltima atividade
        function duplicateLastActivity() {
            // Implementar l√≥gica para duplicar atividade
            alert('üìã Atividade duplicada!');
        }

        // Remover atividade
        function removeActivity(activityId) {
            if (confirm('Tem certeza que deseja remover esta atividade?')) {
                const activityElement = document.getElementById(`activity-${activityId}`);
                if (activityElement) {
                    activityElement.remove();
                }
            }
        }

        // Atualizar contador de caracteres
        function updateCharCounter(activityId) {
            const textarea = document.getElementById(`description-${activityId}`);
            const counter = document.getElementById(`char-counter-${activityId}`);
            const words = textarea.value.trim().split(/\s+/).filter(word => word.length > 0);
            counter.textContent = `${words.length} / 1000 palavras`;
        }

        // Atualizar status do participante
        function updateParticipantStatus(activityId, participantId, type) {
            // Implementar l√≥gica de valida√ß√£o se necess√°rio
        }

        // Verificar usu√°rio lembrado ao carregar a p√°gina
        window.addEventListener('load', function() {
            const rememberedUser = localStorage.getItem('rememberedUser');
            if (rememberedUser) {
                document.getElementById('email').value = rememberedUser;
                document.getElementById('rememberMe').checked = true;
            }
        });

        // Registrar service worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/service-worker.js');
}
</script>
</body>
</html>

